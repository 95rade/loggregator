#!/bin/bash

set -e

rm -rf $(dirname $0)/../release
mkdir -p $(dirname $0)/../release

COMPONENTS="deaagent loggregator trafficcontroller"

function build-architecture {
    COMPONENT=${1}
    echo "Creating $COMPONENT binary..."

    go clean $COMPONENT/$COMPONENT

    go build -v -race $COMPONENT/$COMPONENT

    mv $COMPONENT $(dirname $0)/../release/$COMPONENT
}

for COMPONENT in $COMPONENTS; do
    build-architecture $COMPONENT
done
