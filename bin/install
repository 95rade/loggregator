#!/bin/bash

set -e

function populate_build_info() {
    local main_file=$1

	sed -i -e "s/TRAVIS_BUILD_NUMBER/$TRAVIS_BUILD_NUMBER/g" $main_file
	sed -i -e "s/TRAVIS_COMMIT/$TRAVIS_COMMIT/g" $main_file
}

populate_build_info sources/dea_logging_agent/src/dea_logging_agent/dea_logging_agent/main.go
populate_build_info server/src/loggregator/loggregator/main.go

$(dirname $0)/go install dea_logging_agent/dea_logging_agent
$(dirname $0)/go install loggregator/loggregator

